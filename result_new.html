<!doctype html>
<html lang="zh-TW">

<head>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>åˆ†æçµæœ</title>
    <link rel="stylesheet" href="assets/app.css" />

    <style>
        /* ========================================
       é˜²æ­¢æ‰‹æ©Ÿå·¦å³æ™ƒå‹•
       ======================================== */
        html,
        body {
            overflow-x: hidden;
            max-width: 100vw;
        }

        /* ========================================
       ç¸½è¦½é æ¨£å¼
       ======================================== */
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .section-card {
            padding: 20px;
            border-radius: 18px;
            background: rgba(255, 255, 255, .95);
            border: 1px solid rgba(0, 0, 0, .08);
            box-shadow: 0 12px 40px rgba(0, 0, 0, .08);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .section-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 50px rgba(0, 0, 0, .12);
        }

        .section-title {
            font-size: 18px;
            font-weight: 900;
            margin-bottom: 12px;
            color: rgba(24, 11, 10, .92);
        }

        .section-preview {
            font-size: 14px;
            color: rgba(24, 11, 10, .70);
            line-height: 1.6;
        }

        .section-score {
            font-size: 36px;
            font-weight: 900;
            background: linear-gradient(135deg, rgba(212, 165, 116, .95), rgba(232, 213, 183, .85));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin: 12px 0;
        }

        .section-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 11px;
            font-weight: 700;
            background: rgba(212, 165, 116, .15);
            color: rgba(166, 124, 82, .95);
            margin-top: 8px;
        }

        /* Aå€ç‰¹æ®Šæ¨£å¼ - å·¦å³ä½ˆå±€ */
        .section-card.card-a {
            display: flex;
            gap: 20px;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 220, 200, .95), rgba(255, 210, 180, .90));
        }

        .card-left {
            flex-shrink: 0;
        }

        .card-right {
            flex: 1;
        }

        /* åœ“å½¢åˆ†æ•¸ */
        .score-circle {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: rgba(255, 255, 255, .95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, .08);
        }

        .score-number {
            font-size: 32px;
            font-weight: 900;
            color: rgba(212, 165, 116, .95);
            line-height: 1;
        }

        .score-label {
            font-size: 10px;
            color: rgba(24, 11, 10, .65);
            margin-top: 4px;
        }

        .action-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 8px;
        }

        .action-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: rgba(24, 11, 10, .85);
        }

        .item-icon {
            font-size: 16px;
            flex-shrink: 0;
        }

        /* ========================================
       è©³æƒ…é  - å…¨è¢å¹•æ»¾å‹•
       ======================================== */
        .detail-container {
            display: none;
            height: 100vh;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }

        .detail-container.active {
            display: block;
        }

        .detail-section {
            min-height: 100vh;
            scroll-snap-align: start;
            padding: 100px 20px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }

        .detail-content {
            width: 100%;
            max-width: 800px;
            background: rgba(255, 255, 255, .95);
            border-radius: 22px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, .10);
            box-sizing: border-box;
            overflow: hidden;
        }

        .scroll-hint {
            text-align: center;
            margin-top: 24px;
            font-size: 13px;
            color: rgba(24, 11, 10, .60);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }
        }

        /* ========================================
       æ©«å‘æ»‘å‹•å¡ç‰‡
       ======================================== */
        .horizontal-scroll {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 16px 0;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            width: 100%;
            max-width: 100%;
        }

        .horizontal-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .horizontal-scroll::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, .15);
            border-radius: 999px;
        }

        .product-card {
            flex: 0 0 240px;
            scroll-snap-align: start;
            background: rgba(255, 255, 255, .80);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, .08);
        }

        .product-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: #f5f5f5;
        }

        .product-info {
            padding: 16px;
        }

        .product-brand {
            font-size: 12px;
            color: rgba(24, 11, 10, .60);
            margin-bottom: 4px;
        }

        .product-name {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 8px;
            color: rgba(24, 11, 10, .92);
        }

        .product-ingredient {
            font-size: 12px;
            color: rgba(24, 11, 10, .70);
            margin-bottom: 12px;
        }

        .product-links {
            display: flex;
            gap: 8px;
        }

        .product-link {
            flex: 1;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, .12);
            background: rgba(255, 255, 255, .90);
            text-decoration: none;
            color: rgba(24, 11, 10, .85);
            transition: all 0.2s;
        }

        .product-link:hover {
            background: rgba(212, 165, 116, .15);
            border-color: rgba(212, 165, 116, .30);
        }

        /* ========================================
       æŒ‰éˆ•æ¨£å¼
       ======================================== */
        .back-btn {
            position: fixed;
            top: 24px;
            left: 24px;
            z-index: 100;
            padding: 12px 20px;
            background: rgba(255, 255, 255, .90);
            border: 1px solid rgba(0, 0, 0, .10);
            border-radius: 999px;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(0, 0, 0, .12);
            transition: all 0.2s;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, .16);
        }

        .save-report-btn {
            width: 100%;
            max-width: 400px;
            margin: 32px auto 0;
            padding: 16px 32px;
            background: linear-gradient(135deg, rgba(212, 165, 116, .95), rgba(232, 213, 183, .92));
            border: none;
            border-radius: 999px;
            font-size: 16px;
            font-weight: 900;
            color: rgba(24, 11, 10, .92);
            cursor: pointer;
            box-shadow: 0 12px 32px rgba(212, 165, 116, .25);
            transition: all 0.3s;
        }

        .save-report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 40px rgba(212, 165, 116, .35);
        }

        /* ========================================
       é›·é”åœ–æ¨£å¼
       ======================================== */
        .radar-preview {
            width: 100%;
            max-width: 200px;
            height: 150px;
            margin: 16px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(24, 11, 10, .50);
            font-size: 12px;
        }

        .massage-card {
            background: rgba(255, 255, 255, .95);
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            border: 1px solid rgba(0, 0, 0, .08);
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .massage-gif {
            width: 100%;
            max-width: 300px;
            height: 200px;
            background: #f5f5f5;
            border-radius: 12px;
            margin: 12px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(24, 11, 10, .40);
            font-size: 13px;
        }

        /* ========================================
       æ‰‹æ©Ÿç‰ˆèª¿æ•´
       ======================================== */
        @media (max-width: 768px) {
            .stage {
                padding-left: 12px;
                padding-right: 12px;
            }

            .detail-section {
                padding: 80px 12px 40px;
            }

            .detail-content {
                padding: 24px 16px;
            }

            .back-btn {
                top: 16px;
                left: 16px;
                font-size: 13px;
                padding: 10px 16px;
            }
        }
    </style>
</head>

<body>
    <!-- ========================================
       ç¸½è¦½é é¢
       ======================================== -->
    <div id="overview-page">
        <header>
            <div class="brand">
                <div class="logo"></div>
                <div>
                    <h1>åˆ†æçµæœ</h1>
                    <p>AI çš®è†šåˆ†æå ±å‘Š</p>
                </div>
            </div>
            <button class="btn" onclick="location.href='analyze.html'">å†åˆ†æ</button>
        </header>

        <div class="stage">
            <div class="card" style="max-width: 1000px;">
                <div class="card-head">
                    <div>
                        <div class="title">æ‚¨çš„è†šæ³åˆ†æå ±å‘Š</div>
                        <div class="sub">é»æ“Šä»»ä¸€å€åŸŸæŸ¥çœ‹è©³ç´°è³‡è¨Š</div>
                    </div>
                </div>

                <div class="body">
                    <!-- 4å€‹å€åŸŸå¡ç‰‡ -->
                    <div class="overview-grid">
                        <!-- Aå€ - æ´»åŠ›æ°£è‰²æŒ‡å— -->
                        <div class="section-card" onclick="showDetail('section-a')">
                            <div class="section-title">A. æ´»åŠ›æ°£è‰²æŒ‡å—</div>
                            <div class="section-score" id="overview-score-a">78</div>
                            <div class="section-preview">
                                AI åˆ†ææ‚¨çš„æ°£è‰²ç‹€æ…‹,æä¾›å³æ™‚æ”¹å–„å»ºè­°
                            </div>
                            <div class="section-badge">é»æ“ŠæŸ¥çœ‹è©³æƒ… â†’</div>
                        </div>

                        <!-- Bå€ - æ™ºèƒ½è†šæ³è§£æ -->
                        <div class="section-card" onclick="showDetail('section-b')">
                            <div class="section-title">B. æ™ºèƒ½è†šæ³è§£æ</div>
                            <div class="radar-preview">
                                <canvas id="radar-chart-overview" width="200" height="150" style="display:block; margin:0 auto;"></canvas>
                            </div>
                            <div class="section-preview">
                                åµæ¸¬åˆ° <strong>2 é …</strong> ä¸»è¦å•é¡Œ
                            </div>
                            <div class="section-badge">é»æ“ŠæŸ¥çœ‹è©³æƒ… â†’</div>
                        </div>

                        <!-- Cå€ - ç”±å…§è€Œå¤–é¤Šè†š -->
                        <div class="section-card" onclick="showDetail('section-c')">
                            <div class="section-title">C. ç”±å…§è€Œå¤–é¤Šè†š</div>
                            <div class="section-preview">
                                æ ¹æ“šæ‚¨çš„å•å·çµæœ,æä¾›å€‹äººåŒ–é£²é£Ÿèˆ‡ç”Ÿæ´»å»ºè­°
                            </div>
                            <div class="section-badge">é»æ“ŠæŸ¥çœ‹è©³æƒ… â†’</div>
                        </div>

                        <!-- Då€ - æ™ºæ…§é…æ–¹ -->
                        <div class="section-card" onclick="showDetail('section-d')">
                            <div class="section-title">D. æ™ºæ…§é…æ–¹</div>
                            <div class="section-preview">
                                <strong>6 æ¬¾</strong> ç²¾é¸ç”¢å“æ¨è–¦
                            </div>
                            <div class="section-badge">é»æ“ŠæŸ¥çœ‹è©³æƒ… â†’</div>
                        </div>
                    </div>

                    <!-- å„²å­˜å ±å‘ŠæŒ‰éˆ• -->
                    <button class="save-report-btn" onclick="saveToLine()">
                        å„²å­˜æˆ‘çš„å ±å‘Š
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================
       è©³æƒ…é é¢ - å…¨è¢å¹•æ»¾å‹•
       ======================================== -->
    <div id="detail-page" class="detail-container">
        <button class="back-btn" onclick="backToOverview()">â† è¿”å›ç¸½è¦½</button>

        <!-- Aå€è©³æƒ… - æ´»åŠ›æ°£è‰²æŒ‡å— -->
        <div class="detail-section" data-section="llm_analysis">
            <div class="detail-content">
                <h2 style="margin-top:0;">A. æ´»åŠ›æ°£è‰²æŒ‡å—</h2>

                <!-- ä½¿ç”¨è€…ç…§ç‰‡ -->
                <div style="text-align:center; margin:20px 0;">
                    <img id="user-photo-a"
                        style="max-width:100%; max-height:300px; border-radius:16px; display:none;" />
                    <div style="font-size:13px; color:rgba(24,11,10,.60); margin-top:8px;">æ‚¨çš„æ‹æ”ç…§ç‰‡</div>
                </div>

                <!-- AI è¨ºæ–· -->
                <div class="massage-card">
                    <h3>AI è¨ºæ–·</h3>
                    <p id="ai-diagnosis">æ­£åœ¨åˆ†ææ‚¨çš„æ°£è‰²ç‹€æ…‹...</p>
                </div>

                <!-- æ¿€å‹µçš„è©± -->
                <div class="massage-card">
                    <h3>çµ¦æ‚¨çš„é¼“å‹µ</h3>
                    <p id="ai-encouragement">æ‚¨åšå¾—å¾ˆå¥½!ç¹¼çºŒä¿æŒ!</p>
                </div>

                <!-- æ¨è–¦æŒ‰æ‘© (1-2å€‹,æ©«å‘æ»‘å‹•) -->
                <div class="massage-card">
                    <h3>æ¨è–¦æŒ‰æ‘©</h3>
                    <div class="horizontal-scroll" id="massage-list">
                        <div class="product-card">
                            <div class="massage-gif">æŒ‰æ‘© GIF 1</div>
                            <div class="product-info">
                                <div class="product-name">è‡‰éƒ¨æŒ‰æ‘© (2åˆ†é˜)</div>
                                <div class="product-ingredient">ä¿ƒé€²è¡€æ¶²å¾ªç’°,æå‡æ°£è‰²</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="scroll-hint">å¾€ä¸‹æ»‘å‹•æŸ¥çœ‹è†šæ³åˆ†æ â†“</div>
        </div>

        <!-- Bå€è©³æƒ… - æ™ºèƒ½è†šæ³è§£æ -->
        <div class="detail-section" data-section="model_detection">
            <div class="detail-content">
                <h2 style="margin-top:0;">B. æ™ºèƒ½è†šæ³è§£æ</h2>

                <!-- æ¨™è¨»åœ–ç‰‡ -->
                <div style="text-align:center; margin:20px 0;">
                    <img id="annotated-photo"
                        style="max-width:100%; max-height:300px; border-radius:16px; display:none;" />
                    <div style="font-size:13px; color:rgba(24,11,10,.60); margin-top:8px;">å•é¡Œå€åŸŸæ¨™è¨»åœ–</div>
                </div>

                <!-- äº”è§’é›·é”åœ– -->
                <div style="background:rgba(255,255,255,.80); border-radius:16px; padding:20px; margin:20px 0;">
                    <h3>äº”è§’åˆ†æåœ–</h3>
                    <canvas id="radar-chart" width="400" height="300" style="max-width:100%;"></canvas>
                    <div style="font-size:12px; color:rgba(24,11,10,.60); margin-top:12px; text-align:center;">
                        5 é …æŒ‡æ¨™: ç´°ç´‹ã€æ–‘ã€ç—˜ç—˜ã€ç²‰åˆºã€é»‘çœ¼åœˆ
                    </div>
                </div>

                <!-- æœ€åš´é‡çš„ 2 å€‹å•é¡Œ -->
                <div class="massage-card">
                    <h3>ä¸»è¦å•é¡Œ (æœ€åš´é‡çš„ 2 é …)</h3>
                    <div id="top-issues">
                        <div style="padding:12px; background:rgba(212,165,116,.08); border-radius:12px; margin:8px 0;">
                            <strong>å•é¡Œ 1: ç—˜ç—˜</strong><br>
                            åš´é‡ç¨‹åº¦: <strong>8/10</strong><br>
                            <span style="font-size:12px; color:rgba(24,11,10,.70);">T å­—éƒ¨ä½è¼ƒç‚ºæ˜é¡¯</span>
                        </div>
                        <div style="padding:12px; background:rgba(212,165,116,.08); border-radius:12px; margin:8px 0;">
                            <strong>å•é¡Œ 2: ç´°ç´‹</strong><br>
                            åš´é‡ç¨‹åº¦: <strong>7/10</strong><br>
                            <span style="font-size:12px; color:rgba(24,11,10,.70);">çœ¼å‘¨å€åŸŸ</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="scroll-hint">å¾€ä¸‹æ»‘å‹•æŸ¥çœ‹é£²é£Ÿå»ºè­° â†“</div>
        </div>

        <!-- Cå€è©³æƒ… - ç”±å…§è€Œå¤–é¤Šè†š -->
        <div class="detail-section" data-section="diet_advice">
            <div class="detail-content">
                <h2 style="margin-top:0;">C. ç”±å…§è€Œå¤–é¤Šè†š</h2>

                <!-- ç‡Ÿé¤Šè£œå…… -->
                <div class="massage-card">
                    <h3>ç‡Ÿé¤Šè£œå……å»ºè­°</h3>
                    <ul style="line-height:1.8;">
                        <li>æ·±ç¶ è‰²è”¬èœ (è èœã€ç¾½è¡£ç”˜è—)</li>
                        <li>Omega-3 é£Ÿç‰© (é®­é­šã€æ ¸æ¡ƒ)</li>
                        <li>ç¶­ç”Ÿç´  C æ°´æœ (å¥‡ç•°æœã€æŸ‘æ©˜)</li>
                        <li>å …æœèˆ‡å…¨ç©€é¡</li>
                    </ul>
                </div>

                <!-- ä½œæ¯èª¿æ•´ -->
                <div class="massage-card">
                    <h3>ä½œæ¯èª¿æ•´å»ºè­°</h3>
                    <p>å»ºè­°å›ºå®šå°±å¯¢æ™‚é–“,æ¯æ™šç¡çœ  7-8 å°æ™‚,é€£çºŒ 7 å¤©è§€å¯Ÿæ°£è‰²è®ŠåŒ–ã€‚</p>
                </div>

                <!-- ç”Ÿæ´»ç¿’æ…£ -->
                <div class="massage-card">
                    <h3>ç”Ÿæ´»ç¿’æ…£æ”¹å–„</h3>
                    <p>ä¿æŒè¦å¾‹é‹å‹•,æ¯é€±è‡³å°‘ 3 æ¬¡,æ¯æ¬¡ 30 åˆ†é˜ã€‚é¿å…éåº¦æ›æ›¬,åšå¥½é˜²æ›¬æªæ–½ã€‚</p>
                </div>
            </div>
            <div class="scroll-hint">å¾€ä¸‹æ»‘å‹•æŸ¥çœ‹ç”¢å“æ¨è–¦ â†“</div>
        </div>

        <!-- Då€è©³æƒ… - æ™ºæ…§é…æ–¹ -->
        <div class="detail-section" data-section="product_recommendation">
            <div class="detail-content">
                <h2 style="margin-top:0;">D. æ™ºæ…§é…æ–¹</h2>

                <!-- é‡å°å•é¡Œ A çš„æˆåˆ† -->
                <div class="massage-card">
                    <h3>é‡å°ç—˜ç—˜å•é¡Œ</h3>
                    <p><strong>ä¸»æ”»æ‰‹:</strong> æ°´æ¥Šé…¸</p>
                    <p><strong>æ ¸å¿ƒæˆåˆ†:</strong> èŒ¶æ¨¹ç²¾æ²¹ã€ç…™é†¯èƒº</p>
                    <p style="font-size:13px; color:rgba(24,11,10,.70);">
                        æ°´æ¥Šé…¸èƒ½æ·±å…¥æ¯›å­”,æº¶è§£æ²¹è„‚å’Œè§’è³ª,æœ‰æ•ˆæ”¹å–„ç—˜ç—˜å•é¡Œã€‚
                    </p>
                </div>

                <!-- é‡å°å•é¡Œ B çš„æˆåˆ† -->
                <div class="massage-card">
                    <h3>é‡å°ç´°ç´‹å•é¡Œ</h3>
                    <p><strong>ä¸»æ”»æ‰‹:</strong> è¦–é»ƒé†‡ (Aé†‡)</p>
                    <p><strong>æ ¸å¿ƒæˆåˆ†:</strong> ç»å°¿é…¸ã€èƒœè‚½</p>
                    <p style="font-size:13px; color:rgba(24,11,10,.70);">
                        è¦–é»ƒé†‡èƒ½ä¿ƒé€²è† åŸè›‹ç™½ç”Ÿæˆ,æ¸›å°‘ç´°ç´‹å’Œçšºç´‹ã€‚
                    </p>
                </div>

                <!-- å•†å“æ¨è–¦ (6å€‹,æ©«å‘æ»‘å‹•) -->
                <div class="massage-card">
                    <h3>ç²¾é¸ç”¢å“æ¨è–¦</h3>
                    <div class="horizontal-scroll" id="product-list">
                        <!-- ç”¢å“ 1 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/D4A574/FFFFFF?text=Product+1" alt="ç”¢å“åœ–ç‰‡ 1">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± A</div>
                                <div class="product-name">æ°´æ¥Šé…¸æ·¨ç—˜ç²¾è¯</div>
                                <div class="product-ingredient">å«æœ‰: æ°´æ¥Šé…¸ã€èŒ¶æ¨¹ç²¾æ²¹</div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>

                        <!-- ç”¢å“ 2 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/E8D5B7/FFFFFF?text=Product+2" alt="ç”¢å“åœ–ç‰‡ 2">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± B</div>
                                <div class="product-name">Aé†‡æŠ—çšºç²¾è¯æ¶²</div>
                                <div class="product-ingredient">å«æœ‰: è¦–é»ƒé†‡ã€ç»å°¿é…¸</div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>

                        <!-- ç”¢å“ 3 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/D4A574/FFFFFF?text=Product+3" alt="ç”¢å“åœ–ç‰‡ 3">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± C</div>
                                <div class="product-name">ç…™é†¯èƒºäº®ç™½ç²¾è¯</div>
                                <div class="product-ingredient">å«æœ‰: ç…™é†¯èƒºã€ç¶­ç”Ÿç´ C</div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>

                        <!-- ç”¢å“ 4 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/E8D5B7/FFFFFF?text=Product+4" alt="ç”¢å“åœ–ç‰‡ 4">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± D</div>
                                <div class="product-name">ç»å°¿é…¸ä¿æ¿•ç²¾è¯</div>
                                <div class="product-ingredient">å«æœ‰: ç»å°¿é…¸ã€ç¥ç¶“é†¯èƒº</div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>

                        <!-- ç”¢å“ 5 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/D4A574/FFFFFF?text=Product+5" alt="ç”¢å“åœ–ç‰‡ 5">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± E</div>
                                <div class="product-name">èƒœè‚½ç·Šç·»ç²¾è¯</div>
                                <div class="product-ingredient">å«æœ‰: å…­èƒœè‚½ã€è† åŸè›‹ç™½</div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>

                        <!-- ç”¢å“ 6 -->
                        <div class="product-card">
                            <img class="product-image"
                                src="https://via.placeholder.com/240x180/E8D5B7/FFFFFF?text=Product+6" alt="ç”¢å“åœ–ç‰‡ 6">
                            <div class="product-info">
                                <div class="product-brand">å“ç‰Œåç¨± F</div>
                                <div class="product-name">ç¶­ç”Ÿç´ Cæ·¡æ–‘ç²¾è¯</div>
                                <div class="product-ingredient">å«æœ‰: ç¶­ç”Ÿç´ Cã€ç†Šæœç´ </div>
                                <div class="product-links">
                                    <a href="#" class="product-link">å‰å¾€å®˜ç¶² â†’</a>
                                    <a href="#" class="product-link">å‰å¾€ momo â†’</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å„²å­˜å ±å‘ŠæŒ‰éˆ• -->
                <button class="save-report-btn" onclick="saveToLine()">
                    å„²å­˜æˆ‘çš„å ±å‘Š
                </button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script type="module">
        import { drawRadar, safeJsonFetch, saveResult, toast as appToast } from './assets/app.js';
        // ========================================
        // å·¥å…·å‡½æ•¸
        // ========================================
        function toast(msg) {
            appToast(msg);
        }

        // ========================================
        // é é¢åˆ‡æ›
        // ========================================
        function showDetail(sectionId) {
            document.getElementById('overview-page').style.display = 'none';
            document.getElementById('detail-page').classList.add('active');

            // æ»¾å‹•åˆ°å°æ‡‰å€åŸŸ
            const sectionMap = {
                'section-a': 0,
                'section-b': 1,
                'section-c': 2,
                'section-d': 3
            };

            const sections = document.querySelectorAll('.detail-section');
            const targetIndex = sectionMap[sectionId] || 0;
            sections[targetIndex].scrollIntoView({ behavior: 'smooth' });

            // å¦‚æœé€²å…¥ B å€ï¼ˆæ™ºèƒ½è†šæ³è§£æï¼‰ï¼Œç¹ªè£½é›·é”åœ–
            if (sectionId === 'section-b') {
                // ä½¿ç”¨ requestAnimationFrame ç¢ºä¿ DOM å®Œå…¨æ¸²æŸ“å¾Œæ‰ç¹ªè£½
                requestAnimationFrame(() => {
                    setTimeout(() => {
                        console.log('ğŸ¨ Now drawing radar chart for section B...');
                        const result = loadResult();
                        renderRadar(result);
                    }, 100);
                });
            }

            // GA è¿½è¹¤
            trackSection(sections[targetIndex].dataset.section);
        }

        function backToOverview() {
            document.getElementById('detail-page').classList.remove('active');
            document.getElementById('overview-page').style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ========================================
        // GA è¿½è¹¤
        // ========================================
        function trackSection(sectionName) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'section_view', {
                    section_name: sectionName,
                    page_path: '/result#' + sectionName
                });
            }
            console.log('GA Track:', sectionName);
        }

        // Intersection Observer for auto-tracking
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const sectionName = entry.target.dataset.section;
                    trackSection(sectionName);
                }
            });
        }, {
            threshold: 0.5
        });

        // ç›£è½æ‰€æœ‰è©³æƒ…å€åŸŸ
        document.querySelectorAll('.detail-section').forEach(section => {
            observer.observe(section);
        });

        // ========================================
        // å„²å­˜å ±å‘Šåˆ° LINE
        // ========================================
        function saveToLine() {
            toast('æ­£åœ¨å„²å­˜å ±å‘Š...');
            // TODO: å¯¦ä½œ LINE å›å‚³åŠŸèƒ½
            setTimeout(() => {
                toast('å ±å‘Šå·²å„²å­˜!');
            }, 1000);
        }

        // ========================================
        // è¼‰å…¥è³‡æ–™
        // ========================================
        async function ensureResult() {
            const cached = loadResult();
            if (cached) return cached;

            const res = await safeJsonFetch('./api/mock_result.json', {}, null);
            if (res.ok && res.data) {
                saveResult(res.data);
                return res.data;
            }
            return null;
        }

        // å…±ç”¨çš„é›·é”åœ–ç¹ªè£½å‡½æ•¸
        function drawRadarChart(canvas, result) {
            if (!canvas) {
                console.error('Canvas element not found!');
                return;
            }

            // ç¢ºä¿ canvas æœ‰æ­£ç¢ºçš„å°ºå¯¸
            if (!canvas.width || !canvas.height) {
                canvas.width = canvas.id === 'radar-chart-overview' ? 200 : 400;
                canvas.height = canvas.id === 'radar-chart-overview' ? 150 : 300;
            }

            // å–å¾— metricsï¼Œå¦‚æœæ²’æœ‰å°±ç”¨é è¨­å€¼
            let metrics = result?.metrics;
            if (!metrics) {
                console.warn('No metrics data, using default values');
                metrics = {
                    glow: 70,
                    complexion: 75,
                    blemish: 60,
                    oilBalance: 65,
                    evenness: 70
                };
            }

            const radarValues = {
                "å…‰æ¾¤": Number(metrics.glow ?? 0),
                "æ°£è‰²": Number(metrics.complexion ?? 0),
                "ç‘•ç–µ": Number(metrics.blemish ?? 0),
                "æ²¹æ°´": Number(metrics.oilBalance ?? 0),
                "å‡å‹»": Number(metrics.evenness ?? 0)
            };

            console.log('drawRadarChart called with:', {
                canvasId: canvas.id,
                canvasSize: { width: canvas.width, height: canvas.height },
                metrics: metrics,
                radarValues: radarValues
            });

            try {
                drawRadar(canvas, radarValues);
                console.log(`âœ… Radar chart drawn successfully on ${canvas.id}!`);
            } catch (e) {
                console.error(`âŒ Error drawing radar on ${canvas.id}:`, e);
            }
        }

        // ç‚ºè©³æƒ…é  B å€ç¹ªè£½é›·é”åœ–
        function renderRadar(result) {
            const radar = document.getElementById('radar-chart');
            drawRadarChart(radar, result);
        }

        async function loadData() {
            console.log('loadData started');

            // å¾ localStorage æˆ– API è¼‰å…¥è³‡æ–™
            const result = await ensureResult();
            console.log('Result loaded:', result);

            if (result && result.overall) {
                // æ›´æ–° A å€åˆ†æ•¸
                const scoreEl = document.getElementById('overview-score-a');
                if (scoreEl) {
                    scoreEl.textContent = result.overall;
                }
            }

            // è¼‰å…¥ä½¿ç”¨è€…ç…§ç‰‡
            const userPhoto = localStorage.getItem('user_photo');
            if (userPhoto) {
                const photoEl = document.getElementById('user-photo-a');
                if (photoEl) {
                    photoEl.src = userPhoto;
                    photoEl.style.display = 'block';
                }
            }

            // ç¹ªè£½ç¸½è¦½é é¢çš„é›·é”åœ–ï¼ˆç¸½è¦½é é¢æ˜¯å¯è¦‹çš„ï¼‰
            setTimeout(() => {
                const overviewRadar = document.getElementById('radar-chart-overview');
                if (overviewRadar) {
                    console.log('ğŸ¨ Drawing overview radar chart...');
                    drawRadarChart(overviewRadar, result);
                }
            }, 100);

            toast('è³‡æ–™è¼‰å…¥å®Œæˆ');
        }

        // å¾ localStorage è¼‰å…¥çµæœ
        function loadResult() {
            const keys = ["result", "ai_result", "analysis_result", "payload"];
            for (const k of keys) {
                const raw = localStorage.getItem(k);
                if (!raw) continue;
                try {
                    return JSON.parse(raw);
                } catch (e) {
                    console.error('Parse error:', e);
                }
            }
            // å¦‚æœæ²’æœ‰è³‡æ–™,è¿”å›æ¸¬è©¦æ•¸æ“š
            return {
                overall: 78,
                metrics: {
                    glow: 72,
                    complexion: 80,
                    blemish: 64,
                    oilBalance: 70,
                    evenness: 75
                }
            };
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        window.addEventListener('DOMContentLoaded', loadData);
        window.showDetail = showDetail;
        window.backToOverview = backToOverview;
        window.saveToLine = saveToLine;
    </script>
</body>

</html>
