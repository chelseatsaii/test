:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);

  /* ========================================
     專業高級灰配色系統 (方案 B)
     ======================================== */
  /* 主色調 - 深灰藍 */
  --primary: #2D3748;
  --primary-light: #4A5568;
  --primary-dark: #1A202C;

  /* 點綴色 - 珊瑚橘 */
  --accent: #FF9B82;
  --accent-light: #FFB4A2;
  --accent-dark: #E67E65;

  /* 輔助色 */
  --secondary: #718096;
  --secondary-light: #A0AEC0;

  /* 背景色系 */
  --bg-primary: #F7FAFC;
  --bg-secondary: #EDF2F7;
  --bg-card: #FFFFFF;

  /* 文字色系 */
  --text-dark: #1A202C;
  --text: #2D3748;
  --muted: #718096;
  --text-light: #A0AEC0;

  /* 玻璃效果 */
  --glass-bg: rgba(255, 255, 255, .85);
  --glass-border: rgba(45, 55, 72, .08);

  /* 陰影系統 */
  --shadow: rgba(0, 0, 0, .08);
  --shadow-xs: 0 1px 3px rgba(0, 0, 0, .04);
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, .06);
  --shadow-md: 0 8px 24px rgba(0, 0, 0, .08);
  --shadow-lg: 0 16px 48px rgba(0, 0, 0, .10);
  --shadow-xl: 0 24px 64px rgba(0, 0, 0, .12);

  /* 圓角系統 */
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
  --radius-2xl: 24px;
  --radius-full: 9999px;

  /* 字體系統 */
  --text-xs: 12px;
  --text-sm: 14px;
  --text-base: 16px;
  --text-lg: 20px;
  --text-xl: 28px;
  --text-2xl: 42px;

  /* 版面 */
  --page-max: 1040px;
  --header-h: 76px;
}

html,
body {
  margin: 0;
  min-height: 100%;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  color: var(--text);

  /* ✅ 修正：多頁內容要能滾動 */
  overflow-x: hidden;
  overflow-y: auto;

  /* 專業高級灰背景 */
  background:
    radial-gradient(1200px 900px at 20% 18%, rgba(255, 155, 130, 0.08), transparent 60%),
    radial-gradient(900px 700px at 80% 28%, rgba(160, 174, 192, 0.12), transparent 65%),
    radial-gradient(900px 900px at 50% 90%, rgba(237, 242, 247, 0.95), transparent 60%),
    linear-gradient(180deg, #F7FAFC 0%, #EDF2F7 100%);
}

/* 背景玻璃層 */
.bg-glass {
  position: fixed;
  inset: 0;
  pointer-events: none;
  backdrop-filter: blur(18px) saturate(1.15);
  -webkit-backdrop-filter: blur(18px) saturate(1.15);
  z-index: 0;
}

.bg-glass::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url("background.jpg") center / cover no-repeat;
  /* 放置背景圖片 */
  opacity: .25;
  /* 背景圖透明度 */
  filter: blur(0px);
  /* 想柔一點可改 blur(2px) */
}

.bg-glass::after {
  content: "";
  position: absolute;
  inset: -40px;
  background-image: radial-gradient(rgba(0, 0, 0, .08) 1px, transparent 1px);
  background-size: 22px 22px;
  opacity: .08;
  transform: rotate(-6deg);
}

/* =========================
   Apple Glass Background
   ========================= */

.bg-glass {
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
}

/* 背景圖片層（清楚但降存在感） */
.bg-glass::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url("background.jpg") center / cover no-repeat;
  /* filter: saturate(1.05) contrast(1.02); */
  filter: blur(1px) saturate(1.05);
  opacity: 0.45;
}

/* 玻璃霧化層（Apple 核心） */
.bg-glass::after {
  content: "";
  position: absolute;
  inset: -40px;
  /* 擴大避免邊緣破圖 */

  /* Apple Glass 關鍵 */
  backdrop-filter: blur(22px) saturate(1.2);
  -webkit-backdrop-filter: blur(22px) saturate(1.2);

  /* 微亮霧感 */
  background:
    linear-gradient(180deg,
      rgba(255, 255, 255, .35),
      rgba(255, 255, 255, .15));

  /* 細微顆粒，避免「塑膠感」 */
  background-image:
    radial-gradient(rgba(0, 0, 0, .08) 1px, transparent 1px);
  background-size: 24px 24px;

  opacity: 1;
}


/* ✅ header 改成「固定但不撐爆」：限制寬度＋置中 */
header {
  position: fixed;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: min(var(--page-max), calc(100% - 32px));
  padding: calc(14px + var(--safe-top)) 18px 12px 18px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 10;
  box-sizing: border-box;

  /* ✅ 更像正式產品：header 也玻璃化 */
  background: rgba(255, 255, 255, .35);
  border: 1px solid rgba(0, 0, 0, .06);
  border-radius: 18px;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  box-shadow: 0 18px 60px rgba(0, 0, 0, .10);
}

.brand {
  display: flex;
  gap: 10px;
  align-items: center;
}

.logo {
  width: 34px;
  height: 34px;
  border-radius: 12px;
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  box-shadow: 0 10px 30px var(--shadow);
}

.brand h1 {
  margin: 0;
  font-size: 15px;
  letter-spacing: 1px;
  font-weight: 800;
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.brand p {
  margin: 2px 0 0 0;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: .4px;
}

/* ✅ stage 改成可滾動頁面容器：不再用 height:100% 置中鎖死 */
.stage {
  position: relative;
  z-index: 1;

  /* ✅ 關鍵：避開 fixed header */
  padding:
    calc(var(--header-h) + var(--safe-top) + 18px) 16px calc(24px + var(--safe-bottom)) 16px;

  box-sizing: border-box;

  /* ✅ 內容居中，但高度自適應 */
  display: flex;
  justify-content: center;
  align-items: flex-start;

  min-height: 100vh;
}

/* ✅ 卡片一定要有 max-width，不然會被拉爆 */
.card {
  width: min(980px, 100%);
  max-width: var(--page-max);
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  border-radius: 22px;
  box-shadow: 0 20px 70px rgba(0, 0, 0, .18);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  overflow: hidden;
}

.card-head {
  padding: 16px 16px 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.title {
  margin: 0;
  font-size: 14px;
  letter-spacing: 1px;
  font-weight: 900;
  color: var(--text-dark);
}

.sub {
  margin: 6px 0 0 0;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: .4px;
}

.body {
  padding: 0 16px 16px 16px;
}

/* 按鈕 */
.btn {
  border: 1px solid rgba(0, 0, 0, .10);
  background: rgba(255, 255, 255, .60);
  color: rgba(22, 22, 26, .88);
  padding: 10px 12px;
  border-radius: 14px;
  font-size: 13px;
  letter-spacing: .4px;
  cursor: pointer;
  transition: transform .15s ease, filter .15s ease;
  white-space: nowrap;
  /* ✅ 避免按鈕換行撐爆 header */
}

.btn:hover {
  filter: brightness(1.03);
}

.btn:active {
  transform: scale(.98);
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  border: 1px solid rgba(0, 0, 0, .08);
  color: white;
  font-weight: 900;
  box-shadow: 0 4px 12px rgba(255, 155, 130, 0.25);
}

.btn-lg {
  padding: 14px 90px;
  font-size: 24px;
  border-radius: 200px;
}

/* 版面 */
.row {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  align-items: stretch;
}

.kpi {
  flex: 1 1 220px;
  padding: 12px;
  border-radius: 16px;
  background: rgba(255, 255, 255, .55);
  border: 1px solid rgba(0, 0, 0, .08);
}

/* ✅ Canvas / 圖表區域：不跑版 */
canvas {
  display: block;
  max-width: 100%;
}

.big {
  font-size: 34px;
  font-weight: 950;
  line-height: 1;
  background: linear-gradient(135deg, var(--accent), var(--accent-dark));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.input {
  width: 100%;
  box-sizing: border-box;
  padding: 12px 12px;
  border-radius: 14px;
  background: rgba(255, 255, 255, .62);
  border: 1px solid rgba(0, 0, 0, .10);
  color: rgba(22, 22, 26, .90);
  outline: none;
}

.input::placeholder {
  color: rgba(22, 22, 26, .42);
}

.toast {
  position: fixed;
  left: 50%;
  bottom: calc(16px + var(--safe-bottom));
  transform: translateX(-50%);
  padding: 10px 14px;
  border-radius: 14px;
  background: rgba(0, 0, 0, .78);
  border: 1px solid rgba(255, 255, 255, .18);
  color: rgba(255, 255, 255, .92);
  font-size: 13px;
  letter-spacing: .3px;
  box-shadow: 0 16px 50px rgba(0, 0, 0, .35);
  opacity: 0;
  pointer-events: none;
  transition: opacity .2s ease;
  z-index: 60;
  max-width: min(92vw, 540px);
  text-align: center;
}

.toast.show {
  opacity: 1;
}

/* ✅ 手機：header 變直向更穩 */
@media (max-width: 720px) {
  header {
    width: calc(100% - 24px);
    padding: calc(12px + var(--safe-top)) 14px 10px 14px;
    border-radius: 16px;
  }

  .stage {
    padding-top: calc(var(--header-h) + var(--safe-top) + 12px);
  }

  .btn-lg {
    padding: 14px 48px;
    font-size: 20px;
  }
}